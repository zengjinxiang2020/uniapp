{"version":3,"sources":["webpack:////Users/piao/Documents/Project/yshopmall_uni/main.js","webpack:////Users/piao/Documents/Project/yshopmall_uni/pages/user/PersonalData/index.vue?6cc6","webpack:////Users/piao/Documents/Project/yshopmall_uni/pages/user/PersonalData/index.vue?7aee","webpack:////Users/piao/Documents/Project/yshopmall_uni/pages/user/PersonalData/index.vue?4c03","webpack:////Users/piao/Documents/Project/yshopmall_uni/pages/user/PersonalData/index.vue?96b6","webpack:////Users/piao/Documents/Project/yshopmall_uni/pages/user/PersonalData/index.vue"],"names":["createPage","Page","name","components","data","url","VUE_APP_API_URL","headers","Authorization","$store","state","token","avatar","isWeixin","currentAccounts","switchUserInfo","userIndex","watch","$yroute","n","dispatch","computed","mounted","userInfo","getUserInfo","methods","switchAccounts","index","that","length","undefined","$dialog","toast","mes","user_type","then","wx","hideLoading","expires_time","store","commit","$emit","location","reload","catch","err","cookie","set","res","i","uid","phone","splice","$set","imageuploaded","status","error","msg","submit","nickname","$wx","showToast","title","icon","duration","$yrouter","back","logout","confirm","opts","clearAuthStatus","href","origin"],"mappings":";;;;;;;;;;kDAAA,wCAAmB;;AAEnB;AACA,yG;AACAA,UAAU,CAACC,cAAD,CAAV,C;;;;;;;;;;;;;ACJA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;;;AAGpD;AACmN;AACnN,gBAAgB,iNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACA,IAAI,KAAU,EAAE,YAiBf;AACD;AACe,gF;;;;;;;;;;;;ACzCf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAk1B,CAAgB,myBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC6Ht2B;AACA;AACA;AACA;AACA;AACA;AACA,0E,8FAnIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A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","file":"pages/user/PersonalData/index.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\n\nimport Vue from 'vue'\nimport Page from './pages/user/PersonalData/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=3924982a&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('3924982a')) {\n      api.createRecord('3924982a', component.options)\n    } else {\n      api.reload('3924982a', component.options)\n    }\n    module.hot.accept(\"./index.vue?vue&type=template&id=3924982a&\", function () {\n      api.rerender('3924982a', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"Users/piao/Documents/Project/yshopmall_uni/pages/user/PersonalData/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=3924982a&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapGetters } from \"vuex\";\nimport { trim, isWeixin } from \"@/utils\";\nimport { VUE_APP_API_URL } from \"@/config\";\nimport { postUserEdit, getLogout, switchH5Login, getUser } from \"@/api/user\";\nimport cookie from \"@/utils/store/cookie\";\nimport store from \"@//store\";\nimport dayjs from \"dayjs\";\n\nexport default {\n  name: \"PersonalData\",\n  components: {\n    // VueCoreImageUpload\n  },\n  data: function() {\n    return {\n      url: `${VUE_APP_API_URL}/upload/image`,\n      headers: {\n        Authorization: \"Bearer \" + this.$store.state.token\n      },\n      avatar: \"\",\n      isWeixin: false,\n      currentAccounts: 0,\n      switchUserInfo: [],\n      userIndex: 0\n    };\n  },\n  watch: {\n    $yroute(n) {\n      if (n.name === \"PersonalData\") this.$store.dispatch(\"USERINFO\", true);\n    }\n  },\n  computed: mapGetters([\"userInfo\"]),\n  mounted: function() {\n    this.avatar = this.userInfo.avatar;\n    this.isWeixin = isWeixin();\n    this.getUserInfo();\n  },\n  methods: {\n    switchAccounts: function(index) {\n      let that = this;\n      this.userIndex = index;\n      let userInfo = this.switchUserInfo[this.userIndex];\n      if (this.switchUserInfo.length <= 1) return true;\n      if (userInfo === undefined)\n        return this.$dialog.toast({ mes: \"切换的账号不存在\" });\n      if (userInfo.user_type === \"h5\") {\n        switchH5Login()\n          .then(({ data }) => {\n            wx.hideLoading();\n            const expires_time = dayjs(data.expires_time);\n            store.commit(\"LOGIN\", data.token, expires_time);\n            that.$emit(\"changeswitch\", false);\n            location.reload();\n          })\n          .catch(err => {\n            wx.hideLoading();\n            return that.$dialog.toast({ mes: err });\n          });\n      } else {\n        cookie.set(\"loginType\", \"wechat\", 60);\n        wx.hideLoading();\n        this.$store.commit(\"LOGOUT\");\n        this.$emit(\"changeswitch\", false);\n      }\n    },\n    getUserInfo: function() {\n      let that = this;\n      getUser().then(res => {\n        let switchUserInfo = res.data.switchUserInfo;\n        for (let i = 0; i < switchUserInfo.length; i++) {\n          if (switchUserInfo[i].uid == that.userInfo.uid) that.userIndex = i;\n          if (\n            !that.isWeixin &&\n            switchUserInfo[i].user_type != \"h5\" &&\n            switchUserInfo[i].phone === \"\"\n          )\n            switchUserInfo.splice(i, 1);\n        }\n        that.$set(this, \"switchUserInfo\", switchUserInfo);\n      });\n    },\n    imageuploaded(res) {\n      if (res.status !== 200)\n        return this.$dialog.error(res.msg || \"上传图片失败\");\n      if (this.switchUserInfo[this.userIndex] === undefined) return;\n      this.$set(this.switchUserInfo[this.userIndex], \"avatar\", res.data.url);\n    },\n\n    submit: function() {\n      let userInfo = this.switchUserInfo[this.userIndex];\n      postUserEdit({\n        nickname: trim(this.userInfo.nickname),\n        avatar: userInfo.avatar\n      }).then(\n        res => {\n          this.$store.dispatch(\"USERINFO\", true);\n          this.$wx.showToast({ title: res.msg, icon: \"none\", duration: 2000 });\n          this.$yrouter.back();\n        },\n        error => {\n          this.$dialog.error(error.msg);\n        }\n      );\n    },\n    logout: function() {\n      this.$dialog.confirm({\n        mes: \"确认退出登录?\",\n        opts: () => {\n          getLogout()\n            .then(res => {\n              this.$store.commit(\"LOGOUT\");\n              clearAuthStatus();\n              location.href = location.origin;\n            })\n            .catch(err => {});\n        }\n      });\n    }\n  }\n};\n"],"sourceRoot":""}